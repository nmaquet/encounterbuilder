doctype html

head
    meta(charset="utf-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    meta(name="description", content="Bootstack - Bootstrap 3 Theme")
    meta(name="author", content="Nicolas Maquet & Christophe Muylaert")
    link(rel="shortcut icon", href="assets/ico/favicon.png")
    title Encounter Builder - Home
    link(href="assets/css/bootstrap.min.css", rel="stylesheet")
    link(href="assets/css/main.css", rel="stylesheet")
    link(href="assets/css/linecons.css", rel="stylesheet")
    link(href="assets/css/font-awesome.min.css", rel="stylesheet")
    link(href='http://fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,700', rel='stylesheet', type='text/css')
    link(href="assets/css/jquery.feedback_me.css", rel="stylesheet")
    script(src="assets/js/modernizr.custom.js")

body
    include _navbar
    include _login-modal
    include _register-modal
    include _blog-post-1
    include _footer
    script(src='assets/js/jquery.min.js')
    script(src='assets/js/bootstrap.min.js')
    script(src='assets/js/jquery.easing.1.3.js')
    script(src='assets/js/smoothscroll.js')
    script(src='assets/js/retina.js')
    script.
        $("#login-form").submit(function() {
            $.ajax({
                type: "POST",
                url: '/login',
                data: $("#login-form").serialize(),
                success: function(data) {
                    window.location.href = "/app";
                },
                error: function(data) {
                    $("#login-failed-alert").removeClass("hidden");
                }
             });
             return false; // avoid to execute the actual submit of the form.
        });
        $('#login').on('shown.bs.modal', function () {
            $('#username').focus();
        })
        $(window).load(function(){
            var queryStrings = getQueryStrings();
            if (queryStrings['promptLogin']==='true'){
                $('#login').modal('show');
            }
        });
        function getQueryStrings()
        {
            var vars = {}, hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for(var i = 0; i < hashes.length; i++)
            {
                hash = hashes[i].split('=');
                vars[hash[0]] = hash[1];
            }
            return vars;
        }
