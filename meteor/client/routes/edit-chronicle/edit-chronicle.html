<!--Copyright (c) 2014 DemonSquid, Inc. All rights reserved.-->

<template name="editChronicle">
    <div class="container">
        <h1>Single Chronicle: {{chronicle.name}}</h1>
        <div class="row">
            <button type="button" id="done-button" class="btn btn-primary float-right">done</button>
            <div class="col-xs-2 col-xs-offset-5">
                {{> editChronicle_addButton position="top"}}
            </div>
        </div>
        <div class="row">
            <div id="edit-chronicle-element-list">
                {{#each elements}}
                    {{> editChronicle_element}}
                {{/each}}
            </div>
        </div>
        {{#unless isEmpty}}
            <div class="row">
                <div class="col-xs-2 col-xs-offset-5">
                    {{> editChronicle_addButton position="bottom"}}
                </div>
            </div>
        {{/unless}}
    </div>
    {{> editChronicle_addMonsterModal}}
</template>

<template name="editChronicle_addButton">
    <div class="dropdown pull-middle">
        <button type="button" class="btn btn-default add-button" data-target="#" data-toggle="dropdown">+</button>
        <ul class="dropdown-menu">
            <li><a id="add-text-dropdown-element">Text</a></li>
            <li><a id="add-monster-dropdown-element">Monster</a></li>
            <li><a id="add-encounter-dropdown-element">Encounter</a></li>
        </ul>
    </div>
</template>

<template name="editChronicle_element">
    <div class="well edit-chronicle-element">
        {{#if isEdited}}
            <div class="float-right">
                <button type="button" class="btn btn-primary done-button">done</button>
            </div>
            {{#if isText}}
                {{> editChronicle_editText}}
            {{/if}}
            {{#if isMonster}}
                {{> editChronicle_editMonster}}
            {{/if}}
            {{#if isEncounter}}
                {{> editChronicle_editEncounter}}
            {{/if}}
        {{else}}
            <div class="float-right">
                <button type="button" class="btn btn-primary edit-button">edit</button>
                <button type="button" class="btn btn-danger delete-button">delete</button>
            </div>
            {{#if isText}}
                {{> editChronicle_text}}
            {{/if}}
            {{#if isMonster}}
                {{> editChronicle_monster}}
            {{/if}}
            {{#if isEncounter}}
                {{> editChronicle_encounter}}
            {{/if}}
        {{/if}}
    </div>
</template>

<template name="editChronicle_editText">
    <div>
        <input class="form-control content-title-input" value="{{content.title}}"/>
    </div>
    <div>
        <textarea rows="4" cols="50" class="form-control content-body-textarea">{{content.body}}</textarea>
    </div>
</template>

<template name="editChronicle_editMonster">
    {{#with content}}
        {{> monsterStatBlock}}
    {{/with}}
</template>

<template name="editChronicle_editEncounter">
    <div class="dropdown">
        <button type="button" class="btn btn-primary" data-target="#" data-toggle="dropdown">Add</button>
        <ul class="dropdown-menu">
            <li><a id="add-monster-dropdown-element">Monster</a></li>
            <li><a id="add-npc-dropdown-element">NPC</a></li>
            <li><a id="add-item-dropdown-element">Monster</a></li>
        </ul>
    </div>
    <div>
        <input class="form-control content-name-input" value="{{content.name}}"/>
    </div>
    <ul>
        {{#each elements}}
            <li>
                <span>{{count}}</span>
                <span>{{monster.Name}}</span>
            </li>
        {{/each}}
    </ul>
</template>

<template name="editChronicle_text">
    <div>
        <span>{{content.title}}</span>
    </div>
    <div>
        <p>{{content.body}}</p>
    </div>
</template>

<template name="editChronicle_monster">
    {{#with content}}
        {{> monsterStatBlock}}
    {{/with}}
</template>

<template name="editChronicle_encounter">
    <div>
        <span>content.name</span>
    </div>
    <ul>
        {{#each elements}}
            <li>
                <span>{{count}}</span>
                <span>{{monster.Name}}</span>
            </li>
        {{/each}}
    </ul>
</template>

<template name="editChronicle_addMonsterModal">
    <div class="modal fade" id="add-monster-modal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Add Monster</h4>
                </div>
                <div class="modal-body">
                    <form>
                        {{> inputAutocomplete class="form-control" id="add-monster-search-input" name="query" placeholder="Search..." settings=autocompleteSettings }}
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
</template>